<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Freds</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    body {
      background-color: #f0f0f0; /* Light gray background for a softer feel */
      font-family: Arial, sans-serif; /* Clean font */
      color: #333; /* Dark text for contrast */
    }
    .container {
      max-width: 800px; /* Limit container width for better readability */
      margin: 0 auto; /* Center container */
      padding: 20px;
      text-align: center;
      background: white; /* White background for the container */
      border-radius: 8px; /* Slightly rounded corners */
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); /* Subtle shadow */
    }
    h1 {
      font-size: 2.5em; /* Large heading */
      margin-bottom: 20px;
      color: #2c3e50; /* Darker shade for title */
    }
    h2 {
      font-size: 1.5em; /* Smaller subtitle */
      margin-bottom: 20px;
    }
    .fred-thread {
      background-color: #e0e0e0; /* Slightly darker background for threads */
      border: 1px solid #ccc; /* Border around thread */
      border-radius: 5px; /* Rounded corners for threads */
      padding: 15px;
      margin: 10px 0;
      transition: background 0.3s; /* Smooth hover transition */
      cursor: pointer;
    }
    .fred-thread:hover {
      background-color: #d1d1d1; /* Darker background on hover */
    }
    .fred-title {
      font-size: 1.8em; /* Title size */
      color: #2980b9; /* Blue color for titles */
      text-decoration: none; /* Remove underline */
    }
    .thumbnail {
      width: 100%; /* Make thumbnails responsive */
      max-height: 200px; /* Limit height for uniformity */
      object-fit: cover; /* Crop image to fit */
      border-radius: 5px; /* Rounded corners */
    }
    .recent-comment {
      font-size: 0.9em; /* Smaller text for recent comment */
      color: #7f8c8d; /* Gray color for comment */
      margin-top: 5px; /* Space between comment and title */
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Freds</h1>
    <h2>Select a Fred:</h2>

    <!-- Fred Thread Section -->
    <div class="fred-thread" onclick="window.location.href='chapter1fred.html'">
      <img class="thumbnail" src="your-image-url-here.jpg" alt="Chapter 1 Thumbnail">
      <a class="fred-title">Chapter 1 Fred</a>
      <div class="recent-comment" id="recent-comment-1">Loading recent comment...</div>
    </div>

    <div class="fred-thread" onclick="window.location.href='chapter2fred.html'">
      <img class="thumbnail" src="your-image-url-here.jpg" alt="Chapter 2 Thumbnail">
      <a class="fred-title">Chapter 2 Fred</a>
      <div class="recent-comment" id="recent-comment-2">Loading recent comment...</div>
    </div>

    <div class="fred-thread" onclick="window.location.href='chapter3fred.html'">
      <img class="thumbnail" src="your-image-url-here.jpg" alt="Chapter 3 Thumbnail">
      <a class="fred-title">Chapter 3 Fred</a>
      <div class="recent-comment" id="recent-comment-3">Loading recent comment...</div>
    </div>

    <div class="fred-thread" onclick="window.location.href='chapter4fred.html'">
      <img class="thumbnail" src="your-image-url-here.jpg" alt="Chapter 4 Thumbnail">
      <a class="fred-title">Chapter 4 Fred</a>
      <div class="recent-comment" id="recent-comment-4">Loading recent comment...</div>
    </div>

    <div class="fred-thread" onclick="window.location.href='chapter5fred.html'">
      <img class="thumbnail" src="your-image-url-here.jpg" alt="Chapter 5 Thumbnail">
      <a class="fred-title">Chapter 5 Fred</a>
      <div class="recent-comment" id="recent-comment-5">Loading recent comment...</div>
    </div>

    <div class="fred-thread" onclick="window.location.href='epiloguefred.html'">
      <img class="thumbnail" src="your-image-url-here.jpg" alt="Epilogue Thumbnail">
      <a class="fred-title">Epilogue Fred</a>
      <div class="recent-comment" id="recent-comment-epilogue">Loading recent comment...</div>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBCzabBMFxms9HfX0N411uJQYjEzspSnVk",
      authDomain: "the-virgin-games.firebaseapp.com",
      projectId: "the-virgin-games",
      storageBucket: "the-virgin-games.appspot.com",
      messagingSenderId: "1092738842373",
      appId: "1:1092738842373:web:8bb210d9fb815cc5ae016c"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    async function loadRecentComment(threadId, commentElementId) {
      const threadRef = doc(db, 'chapters', threadId); // Reference to the chapter document
      const threadDoc = await getDoc(threadRef);
      if (threadDoc.exists()) {
        const comments = threadDoc.data().comments || [];
        if (comments.length > 0) {
          // Sort comments by timestamp to get the most recent one
          const mostRecentComment = comments.sort((a, b) => b.timestamp - a.timestamp)[0];
          const commentText = mostRecentComment.text.length > 17
            ? mostRecentComment.text.slice(0, 17) + "..."
            : mostRecentComment.text;
          const commentName = mostRecentComment.name || "Anonymous";
          document.getElementById(commentElementId).innerText = `${commentName}: ${commentText}`;
        }
      } else {
        console.log("No such document!");
      }
    }

    // Load recent comments for each thread
    loadRecentComment('chapter1', 'recent-comment-1');
    loadRecentComment('chapter2', 'recent-comment-2');
    loadRecentComment('chapter3', 'recent-comment-3');
    loadRecentComment('chapter4', 'recent-comment-4');
    loadRecentComment('chapter5', 'recent-comment-5');
    loadRecentComment('epilogue', 'recent-comment-epilogue');
  </script>

  <!-- Navigation Button to Home Page -->
  <a href="index.html" style="position: fixed; top: 10px; left: 10px; z-index: 1000;">
      <img src="https://i.imgur.com/AmjEU0x.png" alt="Home" style="width: 40px; height: 40px;">
  </a>
</body>
</html>
