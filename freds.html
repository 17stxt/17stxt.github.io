<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Freds</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    body {
      background-color: #f0f0f0; /* Light grey background for a forum feel */
      font-family: Arial, sans-serif; /* Use a clean, sans-serif font */
      color: #333; /* Dark text color for contrast */
      margin: 0;
      padding: 0;
    }

    .container {
      max-width: 800px; /* Limit width for readability */
      margin: 20px auto; /* Center container */
      padding: 20px;
      background-color: #fff; /* White background for the container */
      border-radius: 8px; /* Rounded corners for a softer look */
    }

    h1 {
      text-align: center; /* Center headings */
      color: #333; /* Darker color for headings */
    }

    .fred-thread {
      display: flex; /* Flexbox for layout */
      align-items: center; /* Center items vertically */
      background-color: #f9f9f9; /* Light background for each thread */
      border: 1px solid #ddd; /* Border for threads */
      border-radius: 5px; /* Rounded corners */
      padding: 10px; /* Padding inside thread buttons */
      margin: 10px 0; /* Margin between threads */
      cursor: pointer; /* Pointer cursor for clickable threads */
      width: 100%; /* Make the thread buttons wider */
    }

    .fred-image {
      width: 100px; /* Thumbnail size */
      height: 75px; /* Thumbnail size */
      border-radius: 4px; /* Rounded corners for images */
      margin-right: 10px; /* Spacing between image and text */
    }

    .thread-info {
      flex-grow: 1; /* Allow text to take available space */
      display: flex;
      flex-direction: column; /* Stack the title and comment */
    }

    .thread-title {
      font-size: 20px; /* Larger font for thread titles */
      color: #007BFF; /* Blue color for thread titles */
      text-decoration: none; /* Remove underline */
      margin: 0; /* Reset margin */
    }

    .recent-comment {
      font-size: 14px; /* Smaller font for recent comments */
      color: #555; /* Dark grey color for comments */
      margin: 0; /* Reset margin */
    }

    /* Credits Section */
    .credits {
      margin-top: 20px; /* Add margin above the credits section */
      text-align: center; /* Center the credits text */
      font-size: 14px; /* Smaller font size for credits */
      color: #777; /* Grey color for credits text */
    }

    /* Navigation Button Style */
    .nav-button {
      position: fixed; /* Fixed position for home button */
      top: 10px; /* Position from top */
      left: 10px; /* Position from left */
      z-index: 1000; /* Ensure it stays above other elements */
    }

    .nav-button img {
      width: 40px; /* Set image size */
      height: 40px; /* Set image size */
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Freds</h1>
    
    <!-- Thread Buttons -->
    <div class="fred-thread" onclick="window.location.href='chapter1fred.html'">
      <img src="YOUR_CHAPTER_1_IMAGE_URL" alt="Chapter 1" class="fred-image">
      <div class="thread-info">
        <h3 class="thread-title">Chapter 1 fred</h3>
        <p class="recent-comment" id="chapter1RecentComment"></p>
      </div>
    </div>

    <div class="fred-thread" onclick="window.location.href='chapter2fred.html'">
      <img src="YOUR_CHAPTER_2_IMAGE_URL" alt="Chapter 2" class="fred-image">
      <div class="thread-info">
        <h3 class="thread-title">Chapter 2 fred</h3>
        <p class="recent-comment" id="chapter2RecentComment"></p>
      </div>
    </div>

    <div class="fred-thread" onclick="window.location.href='chapter3fred.html'">
      <img src="YOUR_CHAPTER_3_IMAGE_URL" alt="Chapter 3" class="fred-image">
      <div class="thread-info">
        <h3 class="thread-title">Chapter 3 fred</h3>
        <p class="recent-comment" id="chapter3RecentComment"></p>
      </div>
    </div>

    <div class="fred-thread" onclick="window.location.href='chapter4fred.html'">
      <img src="YOUR_CHAPTER_4_IMAGE_URL" alt="Chapter 4" class="fred-image">
      <div class="thread-info">
        <h3 class="thread-title">Chapter 4 fred</h3>
        <p class="recent-comment" id="chapter4RecentComment"></p>
      </div>
    </div>

    <div class="fred-thread" onclick="window.location.href='chapter5fred.html'">
      <img src="YOUR_CHAPTER_5_IMAGE_URL" alt="Chapter 5" class="fred-image">
      <div class="thread-info">
        <h3 class="thread-title">Chapter 5 fred</h3>
        <p class="recent-comment" id="chapter5RecentComment"></p>
      </div>
    </div>

    <div class="fred-thread" onclick="window.location.href='epiloguefred.html'">
      <img src="YOUR_EPILOGUE_IMAGE_URL" alt="Epilogue" class="fred-image">
      <div class="thread-info">
        <h3 class="thread-title">Epilogue fred</h3>
        <p class="recent-comment" id="epilogueRecentComment"></p>
      </div>
    </div>

    <!-- Credits Section -->
    <hr>
    <section class="credits">
      <h3>Credits</h3>
      <p>Email: Awesomecatsandpuppies@gmail.com</p>
      <p>Server: discord.gg/r4hBkmd5Yq</p>
      <p>Team: @7teens, @redmilfed, @yuyuuser</p>
    </section>
  </div>

  <!-- Navigation Button to Home Page -->
  <a href="index.html" class="nav-button">
    <img src="https://i.imgur.com/AmjEU0x.png" alt="Home">
  </a>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js";

    // Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyBCzabBMFxms9HfX0N411uJQYjEzspSnVk",
      authDomain: "the-virgin-games.firebaseapp.com",
      projectId: "the-virgin-games",
      storageBucket: "the-virgin-games.appspot.com",
      messagingSenderId: "1092738842373",
      appId: "1:1092738842373:web:8bb210d9fb815cc5ae016c"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Function to fetch recent comments for threads
    async function fetchRecentComments() {
      const chapters = ['chapter1', 'chapter2', 'chapter3', 'chapter4', 'chapter5', 'epilogue'];

      for (const chapter of chapters) {
        const commentRef = doc(db, chapter, 'comments');
        const commentDoc = await getDoc(commentRef);

        if (commentDoc.exists()) {
          const comments = commentDoc.data().comments || [];
          // Get the most recent comment based on the timestamp
          const recentComment = comments.sort((a, b) => b.timestamp - a.timestamp)[0];
          if (recentComment) {
            const commentText = recentComment.text.length > 17 ? `${recentComment.text.substring(0, 17)}...` : recentComment.text;
            const commentName = recentComment.name || "Anonymous"; // Default to "Anonymous" if name is missing
            document.getElementById(`${chapter}RecentComment`).innerText = `${commentName}: ${commentText}`; // Display comment
          } else {
            document.getElementById(`${chapter}RecentComment`).innerText = ''; // Clear if no comment
          }
        } else {
          document.getElementById(`${chapter}RecentComment`).innerText = ''; // Clear if no document
        }
      }
    }

    // Call the function to fetch comments
    fetchRecentComments();
  </script>
</body>
</html>
